import winreg
import ctypes


def isAdmin():
    try:
        return ctypes.windll.shell32.IsUserAnAdmin()
    except:
        return False


def prepareRegistryPath(path):
    HKeyString, restOfPath = path.split("\\", 1)

    if HKeyString == "HKEY_LOCAL_MACHINE":
        return winreg.HKEY_LOCAL_MACHINE, restOfPath
    elif HKeyString == "HKEY_CURRENT_USER":
        return winreg.HKEY_CURRENT_USER, restOfPath


def getValueFromRegistry(keysWithValue: list[tuple]) -> list:
    startupFolders = []

    for path, value in keysWithValue:
        hkey, registryPath = prepareRegistryPath(path)
        soft = winreg.OpenKeyEx(hkey, registryPath)

        startupPath = winreg.QueryValueEx(soft, value)[0]
        startupFolders.append(startupPath)

        winreg.CloseKey(soft)

    return startupFolders
