from classes.RegistryAnalyzer import RegistryAnalyzer
from classes.FolderAnalyzer import FolderAnalyzer

class MalwareAnalyzer:
    def __init__(self):

        self.registryAnalyzer = RegistryAnalyzer()
        self.folderAnalyzer = FolderAnalyzer()

        self.firstScan = None
        self.secondScan = None

    def compareSnapshots(self, snap1, snap2):
        differenceSet = set(snap2.keys()) - set(snap1.keys())

        difference = {key: snap2[key] for key in differenceSet}
        print(difference)

    def run(self):
        snap1 = self.registryAnalyzer.makeSnapshot()
        input("enter: ")
        snap2 = self.registryAnalyzer.makeSnapshot()

        self.compareSnapshots(snap1, snap2)
