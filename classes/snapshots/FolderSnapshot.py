import hashlib


class FolderSnapshot:
    def __init__(self, _path, _programName):
        self.path = _path
        self.programName = _programName
        self.fileHash = self.getFileHash()

    def getFileHash(self) -> str:
        h = hashlib.md5()
        try:
            with open(f"{self.path}\\{self.programName}", "rb") as f:
                chunk = 0
                while chunk != b'':
                    chunk = f.read(1024)
                    h.update(chunk)
            return h.hexdigest()
        except PermissionError:
            # File is being used
            return "Permission Error"

    def __eq__(self, other):
        return self.path == other.path and self.programName == other.programName and self.fileHash == other.fileHash

    def __hash__(self):
        return hash((self.path, self.programName, self.fileHash))
