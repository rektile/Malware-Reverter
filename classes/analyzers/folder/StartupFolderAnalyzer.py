from classes.analyzers.folder.FolderAnalyzer import FolderAnalyzer
from classes.utils import *
from loguru import logger


class StartupFolderAnalyzer(FolderAnalyzer):
    def __init__(self):
        super().__init__()
        self.startupFolderRegistry = [
            (r"HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders",
             "Common Startup"),
            (r"HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders", "Startup")
        ]

        self.folderPaths = getValueFromRegistry(self.startupFolderRegistry)

    def resultText(self):
        logger.info("")
        logger.info("[!] These are the changes in the startup folders")
