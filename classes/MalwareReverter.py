from classes.analyzers.AutoRunRegistryAnalyzer import AutoRunRegistryAnalyzer
from classes.analyzers.WindowsDefenderAnalyzer import WindowsDefenderAnalyzer
from classes.analyzers.ServiceRegistryAnalyzer import ServiceRegistryAnalyzer

class MalwareReverter:
    def __init__(self):

        self.analyzers = [
            AutoRunRegistryAnalyzer(),
            WindowsDefenderAnalyzer(),
            ServiceRegistryAnalyzer()
        ]

    def makeSnapshots(self) -> list:

        for analyzer in self.analyzers:
            analyzer.makeSnapshot()


    def compareSnapshots(self):

        for analyzer in self.analyzers:
            analyzer.compare()

    def showResults(self):

        for analyzer in self.analyzers:
            analyzer.showResults()

    def run(self):

        print(f"[*] Making first snapshot...")

        self.makeSnapshots()

        input("[-] Press enter when you have fully executed the program. ")

        print(f"[*] Making second snapshot...")

        self.makeSnapshots()

        self.compareSnapshots()

        self.showResults()

