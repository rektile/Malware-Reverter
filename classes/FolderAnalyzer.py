import winreg

class FolderAnalyzer:
    def __init__(self):
        self.startupFolderRegistry = [
            (r"HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders",
             "Common Startup"),
            (r"HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders", "Startup")
        ]

        self.startupFolders = self.initStartupFolders()

    def prepareRegistryPath(self, path):
        HKeyString, restOfPath = path.split("\\", 1)

        match HKeyString:
            case "HKEY_LOCAL_MACHINE":
                return winreg.HKEY_LOCAL_MACHINE, restOfPath
            case "HKEY_CURRENT_USER":
                return winreg.HKEY_CURRENT_USER, restOfPath

    def initStartupFolders(self):

        startupFolders = []

        for path, value in self.startupFolderRegistry:

            hkey, registryPath = self.prepareRegistryPath(path)
            soft = winreg.OpenKeyEx(hkey, registryPath)

            startupPath = winreg.QueryValueEx(soft, value)[0]
            startupFolders.append(startupPath)

            winreg.CloseKey(soft)

        return startupFolders